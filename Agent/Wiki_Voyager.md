# 🧩 VOYAGER 方法与模块全景笔记

> **核心理念：**
> VOYAGER 是首个基于 **大型语言模型（LLM）驱动的开放式终身学习体智能体（Embodied Lifelong Agent）**。
> 它在 Minecraft 世界中通过自主探索、技能积累与自我改进形成持续进化的闭环体系，由三大核心模块构成：
> **Automatic Curriculum（自动课程）、Skill Library（技能库）、Iterative Prompting Mechanism（迭代提示机制）**。
> 智能体无需梯度训练，仅通过 GPT-4 的推理能力、环境反馈与程序执行结果实现长期技能增长与知识复用。

---

![VOYAGER](https://github.com/yuyang-cloud/Wiki/blob/main/Assets/Voyager.jpg?raw=true)

---

## 🚀 整体框架概览

VOYAGER 的目标是：

> **让智能体在无外部奖励与人类干预的条件下，持续探索世界、生成任务、学习技能、积累知识，从而实现“开放式终身学习”。**

### 模型组成

| 模块                                | 功能定位      | 输入                         | 输出           | 实现机制                                       |
| --------------------------------- | --------- | -------------------------- | ------------ | ------------------------------------------ |
| **Automatic Curriculum**          | 任务生成与探索驱动 | 当前环境状态（背包、位置、生物群落、时间、健康值等） | 下一个任务目标 Tₚ   | GPT-4 Prompt 生成（in-context novelty search） |
| **Skill Library**                 | 技能积累与复用   | 当前任务描述 + 环境反馈              | 可执行代码函数 fₚ   | 向量数据库存储与检索（GPT-3.5 embedding）              |
| **Iterative Prompting Mechanism** | 代码生成与自我改进 | 上轮代码 + 环境反馈 + 执行错误         | 修正后的程序 / 新技能 | 多轮 GPT-4 Prompt + 自验证 (Self-Verification)  |

三者形成循环：

> Curriculum → Code Generation → Execution → Feedback → Self-Verification → Skill Library → Curriculum

---

## 🧭 Automatic Curriculum（自动课程模块）

### ✅ 功能定位

* 负责在开放世界中生成多样化、渐进式的探索任务；
* 基于 GPT-4 的世界知识与当前状态，提出“当前可完成且能带来新发现”的任务；
* 实现一种类“**新奇性搜索（novelty search）**”的自动任务进化机制。

### ⚙️ 输入与输出

| 输入                                                                   | 输出                                  |
| -------------------------------------------------------------------- | ----------------------------------- |
| - 背包、装备、坐标、生物群落、时间、生命值、饥饿度<br>- 已完成 / 失败任务列表<br>- GPT-3.5 生成的自问自答上下文 | - 当前任务目标（如 “Craft 1 Stone Pickaxe”） |

### 🧩 特点

* 底层自驱动，不依赖预定义 reward；
* 自适应任务难度控制；
* 支持动态世界变化；
* 通过 GPT-4 temperature=0.1 保持任务多样性。

---

## 🧠 Skill Library（技能库模块）

### ✅ 功能定位

* 存储、索引与复用智能体已掌握的技能；
* 每项技能以**程序形式**表示（如 `craftWoodenPickaxe()`）；
* 通过组合已有技能，快速生成更复杂行为。

### ⚙️ 内部机制

| 子过程                   | 描述                                                                     |
| --------------------- | ---------------------------------------------------------------------- |
| **Skill Addition**    | GPT-4 成功完成任务后，将生成代码及其自然语言描述存储进向量数据库；Key = 描述 embedding，Value = 程序。     |
| **Skill Retrieval**   | 新任务到来时，GPT-3.5 根据任务语义生成查询 embedding，检索 Top-K 相似技能；作为上下文供 GPT-4 代码生成参考。 |
| **Skill Composition** | GPT-4 通过 in-context learning 组合旧技能，生成复杂技能函数。                           |

### 💡 优势

* 实现长期记忆；
* 避免灾难性遗忘；
* 提高代码生成效率与可解释性；
* 可作为外部模块增强其他 Agent（如 AutoGPT）。

---

## 🧩 Iterative Prompting Mechanism（迭代提示机制）

### ✅ 核心目标

* 让 GPT-4 在无监督条件下通过执行反馈**自我改进代码**；
* 实现“编写 → 运行 →调试 →验证”的闭环。

### ⚙️ 输入与输出

| 输入                                                 | 输出                              |
| -------------------------------------------------- | ------------------------------- |
| - 上一轮程序代码<br>- 环境反馈（资源不足、任务未达成）<br>- 执行错误（语法/逻辑错误） | - 改进后代码<br>- 新增技能函数<br>- 任务成功信号 |

### ⚙️ 三类反馈机制

1. **Environment Feedback**

   * 来自游戏世界的状态更新（如 “缺少2块木板”）；
   * 由 `bot.chat()` 输出，提示资源或时机问题。

2. **Execution Error**

   * 程序解释器返回的报错信息（如 “No item named acacia_axe”）；
   * 用于修复无效 API 调用或逻辑错误。

3. **Self-Verification（自验证）**

   * 独立的 GPT-4 模块判断任务是否完成；
   * 若失败，返回改进建议；
   * 相当于自动 critic + self-reflection。

### 🔁 工作流程

1. GPT-4 生成任务代码；
2. 代码执行 → 返回反馈；
3. GPT-4 结合反馈重新生成；
4. Self-Verification 判定成功 → 存入 Skill Library；
5. 若 4 轮未成功 → Curriculum 生成新任务。

---

## 🧮 实验与结果

| 指标        | VOYAGER 表现  | 相比基线提升   |
| --------- | ----------- | -------- |
| **探索性能**  | 发现 63 种独特物品 | 3.3×     |
| **移动距离**  | 跨越地形多样区域    | 2.3×     |
| **科技树掌握** | 达成木→石→铁→钻石链 | 最高 15.3× |
| **零样本泛化** | 能在新世界完成未见任务 | 完全超越基线   |

### 📊 对比基线

| 方法          | 特性          | 是否具备终身学习 | 结果     |
| ----------- | ----------- | -------- | ------ |
| ReAct       | 推理+行动       | ✖        | 无法完成任务 |
| Reflexion   | 自反思         | ✖        | 停滞     |
| AutoGPT     | 任务分解        | ✖        | 可解简单任务 |
| **VOYAGER** | 自动课程 + 技能复用 | ✅        | 持续进化   |

### ⚙️ 消融实验发现

* 移除 Automatic Curriculum → 探索数 ↓ 93%；
* 移除 Skill Library → 晚期性能停滞；
* 移除 Self-Verification → 探索数 ↓ 73%；
* 用 GPT-3.5 代替 GPT-4 → 探索数 ↓ 5.7×。

---

## 🧩 模块间训练与依赖关系

| 模块                       | 是否训练        | 主要输入        | 主要输出    | 关键作用      |
| ------------------------ | ----------- | ----------- | ------- | --------- |
| **Automatic Curriculum** | ❌（Prompt）   | 环境状态、任务历史   | 新任务     | 任务生成与探索驱动 |
| **Skill Library**        | ✅（动态积累）     | 程序描述、执行成功技能 | 可复用函数集合 | 长期记忆与复用   |
| **Iterative Prompting**  | ❌（Prompt循环） | 上轮代码、环境反馈   | 修正后程序   | 自我改进与验证   |

---

## 🔁 自进化循环流程图

```
      ┌──────────────────────────────┐
      │   Automatic Curriculum (GPT-4) │
      │  - 生成任务 Tₚ                 │
      │  - 控制探索方向                │
      └──────────────┬───────────────┘
                     │
                     ▼
      ┌──────────────────────────────┐
      │ Iterative Prompting Mechanism │
      │  - 生成可执行程序 fₚ          │
      │  - 执行 + 收集反馈             │
      └──────────────┬───────────────┘
                     │
                     ▼
      ┌──────────────────────────────┐
      │      Minecraft Environment   │
      │  - 返回环境状态/错误/成败      │
      └──────────────┬───────────────┘
                     │
                     ▼
      ┌──────────────────────────────┐
      │     Self-Verification (GPT-4) │
      │  - 判断任务是否完成            │
      │  - 给出改进建议                │
      └──────────────┬───────────────┘
                     │
                     ▼
      ┌──────────────────────────────┐
      │         Skill Library         │
      │  - 存储新技能                 │
      │  - 检索旧技能组合             │
      └──────────────┬───────────────┘
                     │
                     ▼
           Automatic Curriculum 更新任务
```

---

## 🧩 模块协同闭环（Self-Improving Agent）

> **闭环逻辑：**
>
> 1️⃣ **Curriculum** 提出探索目标；
> 2️⃣ **Iterative Prompting** 生成并优化代码；
> 3️⃣ **环境执行** 返回反馈；
> 4️⃣ **Self-Verification** 判断并总结成功经验；
> 5️⃣ **Skill Library** 存储可复用技能；
> 6️⃣ **Curriculum** 基于已掌握技能生成更复杂任务。

形成“**任务 → 执行 → 反馈 → 记忆 → 再任务**”的自我进化循环。

---

## 📊 关键实验结论

* **自动课程** 显著加速技能成长；
* **技能库** 促进可组合能力的持续积累；
* **迭代提示机制** 提升 LLM 行动一致性；
* **Self-Verification** 是自进化的关键节点；
* **VOYAGER** 的技能库还可迁移至其他 Agent 框架中使用（plug-and-play）。

---

## ⚠️ 局限与展望

| 问题   | 描述                      | 未来方向                       |
| ---- | ----------------------- | -------------------------- |
| 成本   | GPT-4 调用昂贵（15× GPT-3.5） | 开源 LLM 自训                  |
| 不稳定性 | 任务卡死或验证误判               | 更强自监控机制                    |
| 幻觉问题 | 生成不存在物品或函数              | 外部知识约束                     |
| 视觉缺失 | 当前无感知输入                 | 接入多模态模型（PaLM-E, Prismer 等） |

---

## 🧭 总结

> **VOYAGER 的核心创新点：**

1. 用 **LLM + 代码执行** 代替传统强化学习，实现终身学习；
2. 构建 **Automatic Curriculum** → **Skill Library** → **Iterative Prompting** 闭环；
3. 在开放式环境中实现**自生成任务、自修复代码、自积累技能**；
4. 提供可迁移的“技能记忆库”，为下一代自主智能体奠基。

> **一句话总结：**
> VOYAGER = “**GPT-4 as Brain + Code as Action + World as Teacher**”，
> 是通往通用体智能（General Embodied Intelligence）的重要一步。
